<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fastrac Solar Pricing Calculator</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #1A2A44;
            color: #fff;
            position: relative;
        }
        .calculator {
            background: #2E4057;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0,0,0,0.3);
        }
        h1 {
            text-align: center;
            color: #F28C38;
        }
        .input-group, .output-group {
            margin: 15px 0;
        }
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        input, select {
            width: 100%;
            padding: 8px;
            margin-bottom: 10px;
            border: 1px solid #4A6280;
            border-radius: 4px;
            background-color: #34495E;
            color: #fff;
        }
        button {
            background-color: #F28C38;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            width: 100%;
        }
        button:hover {
            background-color: #E67E22;
        }
        .output-group {
            display: none;
        }
        .output-group.show {
            display: block;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
        }
        th, td {
            border: 1px solid #4A6280;
            padding: 8px;
            text-align: left;
        }
        th {
            background-color: #34495E;
        }
    </style>
</head>
<body>
    <div class="calculator">
        <h1>Fastrac Solar Pricing Calculator</h1>
        <div class="input-group">
            <label for="salesPrice">Sales Price (PPW):</label>
            <input type="number" id="salesPrice" step="0.01" value="">
            
            <label for="redline">Redline:</label>
            <input type="number" id="redline" step="0.01" value="">
            
            <label for="panels">Number of 410W Panels:</label>
              <select id="panels">
                <option value="18">18 </option>
                <option value="19">19 </option>
                <option value="20">20 </option>
                <option value="21">21 </option>
                <option value="22">22 </option>
                <option value="23">23 </option>
                <option value="24">24 </option>
                <option value="25">25 </option>
                <option value="26">26 </option>
                <option value="27">27 </option>
                <option value="28">28 </option>
                <option value="29">29 </option>
                <option value="30">30 </option>
                <option value="31">31 </option>
                <option value="32">32 </option>
                <option value="33">33 </option>
                <option value="34">34 </option>
                <option value="35">35 </option>
                <option value="36">36 </option>
                <option value="37">37 </option>
                <option value="38">38 </option>
                <option value="39">39 </option>
                <option value="40">40 </option>
                <option value="41">41 </option>
                <option value="42">42 </option>
                <option value="43">43 </option>
                <option value="44">44 </option>
                <option value="45">45 </option>
                <option value="46">46 </option>
                <option value="47">47 </option>
                <option value="48">48 </option>
                <option value="49">49 </option>
                <option value="50">50 </option>
                <option value="51">51 </option>
                <option value="52">52 </option>
                <option value="53">53 </option>
                <option value="54">54 </option>
                <option value="55">55 </option>
                <option value="56">56 </option>
                <option value="57">57 </option>
                <option value="58">58 </option>
                <option value="59">59 </option>
                <option value="60">60 </option>
                <option value="61">61 </option>
                <option value="62">62 </option>
                <option value="63">63 </option>
                <option value="64">64 </option>
                <option value="65">65 </option>
                <option value="66">66 </option>
                <option value="67">67 </option>
                <option value="68">68 </option>
                <option value="69">69 </option>
                <option value="70">70 </option>
                <option value="71">71 </option>
                <option value="72">72 </option>
                <option value="73">73 </option>
                <option value="74">74 </option>             
                <option value="75">75 </option>
            </select>
            
            <label for="powerWalls">Number of PowerWalls:</label>
            <select id="powerWalls">
                <option value="1">1 PowerWall</option>
                <option value="2">2 PowerWalls</option>
                <option value="3">3 PowerWalls</option>
            </select>
            
            <label for="totalAdderCost">Total Adder Cost:</label>
            <input type="number" id="totalAdderCost" step="0.01" value="0.00">
            
            <button onclick="calculate()">Calculate</button>
        </div>
        <div class="output-group" id="output">
            <h2>Results</h2>
            <table>
                <tr>
                    <th>Metric</th>
                    <th>Value</th>
                </tr>
                <tr>
                    <td>System Size (Watts)</td>
                    <td id="systemSize"></td>
                </tr>
                <tr>
                    <td>EPC PPW</td>
                    <td id="epcPPW"></td>
                </tr>
                <tr>
                    <td>EPC Amount</td>
                    <td id="epcAmount"></td>
                </tr>
                <tr>
                    <td>Estimated Commission After Adders</td>
                    <td id="commissionAfterAdders"></td>
                </tr>
            </table>
        </div>
         <h5>**PRICES ABOVE ARE ONLY AN ESTIMATE**</h5>
    </div>
    <script>
        // Pricing matrix data extracted from the CSV - Column C (1 PW), Column D (2 PW), Column E (3 PW)
        const onePWPPW = [
            null, // index 0
            null, // index 1
            { panels: 18, base: 1.98 },
            { panels: 19, base: 1.92 },
            { panels: 20, base: 1.86 },
            { panels: 21, base: 1.81 },
            { panels: 22, base: 1.77 },
            { panels: 23, base: 1.72 },
            { panels: 24, base: 1.68 },
            { panels: 25, base: 1.65 },
            { panels: 26, base: 1.62 },
            { panels: 27, base: 1.59 },
            { panels: 28, base: 1.56 },
            { panels: 29, base: 1.53 },
            { panels: 30, base: 1.51 },
            { panels: 31, base: 1.49 },
            { panels: 32, base: 1.47 },
            { panels: 33, base: 1.44 },
            { panels: 34, base: 1.43 },
            { panels: 35, base: 1.41 },
            { panels: 36, base: 1.39 },
            { panels: 37, base: 1.38 },
            { panels: 38, base: 1.36 },
            { panels: 39, base: 1.35 },
            { panels: 40, base: 1.33 },
            { panels: 41, base: 1.32 },
            { panels: 42, base: 1.31 },
            { panels: 43, base: 1.30 },
            { panels: 44, base: 1.29 },
            { panels: 45, base: 1.27 },
            { panels: 46, base: 1.27 },
            { panels: 47, base: 1.26 },
            { panels: 48, base: 1.25 },
            { panels: 49, base: 1.72 },
            { panels: 50, base: 1.70 },
            { panels: 51, base: 1.68 },
            { panels: 52, base: 1.67 },
            { panels: 53, base: 1.65 },
            { panels: 54, base: 1.54 },
            { panels: 55, base: 1.63 },
            { panels: 56, base: 1.61 },
            { panels: 57, base: 1.60 },
            { panels: 58, base: 1.59 },
            { panels: 59, base: 1.58 },
            { panels: 60, base: 1.57 },
            { panels: 61, base: 1.56 },
            { panels: 62, base: 1.55 },
            { panels: 63, base: 1.53 },
            { panels: 64, base: 1.53 },
            { panels: 65, base: 1.49 },
            { panels: 66, base: 1.51 },
            { panels: 67, base: 1.50 },
            { panels: 68, base: 1.49 },
            { panels: 69, base: 1.48 },
            { panels: 70, base: 1.47 },
            { panels: 71, base: 1.46 },
            { panels: 72, base: 1.46 },
            { panels: 73, base: 1.45 },
            { panels: 74, base: 1.44 },
            { panels: 75, base: 1.43 }
        ];

        const twoPWPPW = [
            null, // index 0
            null, // index 1
            { panels: 18, base: 3.37 },
            { panels: 19, base: 3.24 },
            { panels: 20, base: 3.11 },
            { panels: 21, base: 3.00 },
            { panels: 22, base: 2.90 },
            { panels: 23, base: 2.80 },
            { panels: 24, base: 2.72 },
            { panels: 25, base: 2.64 },
            { panels: 26, base: 2.57 },
            { panels: 27, base: 2.51 },
            { panels: 28, base: 2.44 },
            { panels: 29, base: 2.38 },
            { panels: 30, base: 2.33 },
            { panels: 31, base: 2.29 },
            { panels: 32, base: 2.24 },
            { panels: 33, base: 2.19 },
            { panels: 34, base: 2.15 },
            { panels: 35, base: 2.11 },
            { panels: 36, base: 2.07 },
            { panels: 37, base: 2.04 },
            { panels: 38, base: 2.00 },
            { panels: 39, base: 1.98 },
            { panels: 40, base: 1.94 },
            { panels: 41, base: 1.91 },
            { panels: 42, base: 1.89 },
            { panels: 43, base: 1.87 },
            { panels: 44, base: 1.84 },
            { panels: 45, base: 1.81 },
            { panels: 46, base: 1.80 },
            { panels: 47, base: 1.77 },
            { panels: 48, base: 1.75 },
            { panels: 49, base: 2.11 },
            { panels: 50, base: 2.08 },
            { panels: 51, base: 2.05 },
            { panels: 52, base: 2.03 },
            { panels: 53, base: 2.00 },
            { panels: 54, base: 1.98 },
            { panels: 55, base: 1.97 },
            { panels: 56, base: 1.94 },
            { panels: 57, base: 1.92 },
            { panels: 58, base: 1.90 },
            { panels: 59, base: 1.88 },
            { panels: 60, base: 1.87 },
            { panels: 61, base: 1.85 },
            { panels: 62, base: 1.83 },
            { panels: 63, base: 1.81 },
            { panels: 64, base: 1.80 },
            { panels: 65, base: 1.75 },
            { panels: 66, base: 1.77 },
            { panels: 67, base: 1.75 },
            { panels: 68, base: 1.74 },
            { panels: 69, base: 1.72 },
            { panels: 70, base: 1.71 },
            { panels: 71, base: 1.69 },
            { panels: 72, base: 1.69 },
            { panels: 73, base: 1.67 },
            { panels: 74, base: 1.66 },
            { panels: 75, base: 1.64 }
        ];

        const threePWPPW = [
            null, // index 0
            null, // index 1
            { panels: 18, base: 4.80 },
            { panels: 19, base: 4.59 },
            { panels: 20, base: 4.39 },
            { panels: 21, base: 4.22 },
            { panels: 22, base: 4.07 },
            { panels: 23, base: 3.92 },
            { panels: 24, base: 3.78 },
            { panels: 25, base: 3.67 },
            { panels: 26, base: 3.56 },
            { panels: 27, base: 3.46 },
            { panels: 28, base: 3.36 },
            { panels: 29, base: 3.27 },
            { panels: 30, base: 3.19 },
            { panels: 31, base: 3.11 },
            { panels: 32, base: 3.04 },
            { panels: 33, base: 2.96 },
            { panels: 34, base: 2.91 },
            { panels: 35, base: 2.84 },
            { panels: 36, base: 2.78 },
            { panels: 37, base: 2.73 },
            { panels: 38, base: 2.68 },
            { panels: 39, base: 2.63 },
            { panels: 40, base: 2.58 },
            { panels: 41, base: 2.54 },
            { panels: 42, base: 2.50 },
            { panels: 43, base: 2.46 },
            { panels: 44, base: 2.42 },
            { panels: 45, base: 2.38 },
            { panels: 46, base: 2.35 },
            { panels: 47, base: 2.32 },
            { panels: 48, base: 2.29 },
            { panels: 49, base: 2.64 },
            { panels: 50, base: 2.59 },
            { panels: 51, base: 2.55 },
            { panels: 52, base: 2.52 },
            { panels: 53, base: 2.49 },
            { panels: 54, base: 2.46 },
            { panels: 55, base: 2.43 },
            { panels: 56, base: 2.39 },
            { panels: 57, base: 2.37 },
            { panels: 58, base: 2.34 },
            { panels: 59, base: 2.32 },
            { panels: 60, base: 2.29 },
            { panels: 61, base: 2.27 },
            { panels: 62, base: 2.25 },
            { panels: 63, base: 2.21 },
            { panels: 64, base: 2.20 },
            { panels: 65, base: 2.15 },
            { panels: 66, base: 2.16 },
            { panels: 67, base: 2.13 },
            { panels: 68, base: 2.11 },
            { panels: 69, base: 2.09 },
            { panels: 70, base: 2.07 },
            { panels: 71, base: 2.05 },
            { panels: 72, base: 2.04 },
            { panels: 73, base: 2.02 },
            { panels: 74, base: 2.00 },
            { panels: 75, base: 1.98 }
        ];

        function getBasePPW(panels, powerWalls) {
            const data = {
                1: onePWPPW,
                2: twoPWPPW,
                3: threePWPPW
            };
            const array = data[powerWalls];
            const entry = array.find(e => e && e.panels === panels);
            return entry ? entry.base : null;
        }

        function calculate() {
            const salesPrice = parseFloat(document.getElementById('salesPrice').value);
            const redline = parseFloat(document.getElementById('redline').value);
            const panels = parseInt(document.getElementById('panels').value);
            const powerWalls = parseInt(document.getElementById('powerWalls').value);
            const totalAdderCost = parseFloat(document.getElementById('totalAdderCost').value);

            if (isNaN(salesPrice) || isNaN(redline) || isNaN(panels) || isNaN(powerWalls) || isNaN(totalAdderCost)) {
                alert('Please enter valid numbers for all inputs.');
                return;
            }
         

            const systemSize = panels * 410;
            const basePPW = getBasePPW(panels, powerWalls);
            if (basePPW === null) {
                alert('Invalid number of panels or PowerWalls configuration.');
                return;
            }
            const epcPPW = redline + basePPW; // EPC PPW = Redline + Total System Cost/Watt
            const epcAmount = (epcPPW * systemSize).toFixed(2);
            const commissionAfterAdders = ((salesPrice - epcPPW - (totalAdderCost / systemSize)) * systemSize).toFixed(2);

            document.getElementById('systemSize').textContent = systemSize.toLocaleString();
            document.getElementById('epcPPW').textContent = epcPPW.toFixed(2);
            document.getElementById('epcAmount').textContent = `$${parseFloat(epcAmount).toLocaleString()}`;
            document.getElementById('commissionAfterAdders').textContent = `$${parseFloat(commissionAfterAdders).toLocaleString()}`;
            document.getElementById('output').classList.add('show');
        }
    </script>
</body>
</html>
